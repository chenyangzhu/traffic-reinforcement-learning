import numpy as np


def speed_matrix(flag, id):
    '''
    TODO 这里直接和kh的模型进行对接，
    注意要加上不同的15分钟时间段，直接写到V里去即可，
    :param:
    flag: "morning" or "afternoon"
    id:   "A"/"B"/"C"/"D"

    :return:
    speed matrix with time embedded, the shape is
        number of time periods x 4 x 4
    4x4 is just all directions
    number of time periods = 早高峰or晚高峰总长 / 15min间隔
    '''

    mV_1 = np.array(
        [[6.6457, 7.8258, 8.9372, 7.5126], [8.4115, 6.5528, 8.7679, 7.5184], [9.384, 9.0436, 8.2904, 7.9447],
         [7.484, 7.4867, 8.0066, 5.9959]])*10000
    mV_2 = np.array(
        [[7.5451, 7.0053, 8.9476, 8.4978], [7.3584, 5.408, 7.3179, 7.4435], [9.4287, 8.6249, 7.9717, 7.564],
         [8.2523, 7.133, 8.2126, 7.5429]])*10000
    mV_3 = np.array(
        [[7.2576, 8.8443, 8.8698, 8.6086], [9.607, 8.3618, 7.6701, 9.6802], [8.954, 8.3575, 7.0293, 7.1893],
         [9.2592, 10.4052, 7.6567, 7.1195]])*10000
    mV_4 = np.array(
        [[6.6174, 7.9762, 6.4442, 7.0779], [7.4318, 4.1769, 7.0859, 8.1752], [6.6421, 7.3496, 5.524, 6.1823],
         [6.6792, 7.8172, 6.2007, 5.6317]])*10000

    morning = {"A": mV_1, "B": mV_2, "C": mV_3, "D": mV_4}
    afternoon = {"A": mV_1, "B": mV_2, "C": mV_3, "D": mV_4}

    if flag == "morning":
        return morning[id]
    if flag == "afternoon":
        return afternoon[id]


def transition_matrix():

    P_1 = np.array(
        [[0.0152, 0.0607, 0.7909, 0.1332], [0.1054, 0.0041, 0.6108, 0.2797], [0.5771, 0.3029, 0.0245, 0.0954],
         [0.1148, 0.2991, 0.574, 0.0121]])
    P_2 = np.array(
        [[0.0173, 0.0218, 0.5971, 0.3638], [0.1263, 0.0053, 0.4579, 0.4105], [0.7537, 0.0939, 0.0154, 0.137],
         [0.6154, 0.1455, 0.2324, 0.0067]])
    P_3 = np.array(
        [[0.0319, 0.242, 0.4447, 0.2814], [0.2959, 0.0062, 0.0456, 0.6523], [0.4808, 0.0369, 0.0084, 0.4739],
         [0.2577, 0.4082, 0.3238, 0.0103]])
    P_4 = np.array(
        [[0.0029, 0.0068, 0.25, 0.7403], [0.1462, 0.0012, 0.1155, 0.7371], [0.3828, 0.2051, 0.0039, 0.4082],
         [0.3675, 0.4522, 0.177, 0.0034]])

    return {"A": P_1,
            "B": P_2,
            "C": P_3,
            "D": P_4}
